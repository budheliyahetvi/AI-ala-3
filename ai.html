<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>DoctorBot — Simple Web Chatbot</title>
  <style>
    :root{--bg:#f6f8fb;--card:#ffffff;--accent:#2563eb;--muted:#6b7280}
    *{box-sizing:border-box}
    body{font-family:Inter,system-ui,Segoe UI,Roboto,"Helvetica Neue",Arial; margin:0; background:var(--bg); color:#0f172a}
    .container{max-width:720px;margin:32px auto;padding:20px}
    .card{background:var(--card);border-radius:12px;box-shadow:0 6px 18px rgba(10,20,40,0.06);overflow:hidden}
    header{padding:18px 20px;border-bottom:1px solid #eef2ff;display:flex;align-items:center;gap:12px}
    header h1{font-size:18px;margin:0}
    header p{margin:0;color:var(--muted);font-size:13px}

    .chat-area{height:480px;overflow:auto;padding:18px;display:flex;flex-direction:column;gap:12px}
    .msg{max-width:78%;padding:10px 14px;border-radius:14px;line-height:1.25}
    .user{align-self:flex-end;background:linear-gradient(180deg,#e0f2fe,#bae6fd);border-bottom-right-radius:6px}
    .bot{align-self:flex-start;background:#f3f4f6;border-bottom-left-radius:6px}
    .meta{font-size:12px;color:var(--muted);margin-top:6px}

    .composer{display:flex;padding:14px;border-top:1px solid #eef2ff;gap:8px}
    .composer input{flex:1;padding:12px 14px;border-radius:10px;border:1px solid #e6eef8;font-size:14px}
    .composer button{background:var(--accent);color:white;border:none;padding:10px 14px;border-radius:10px;font-weight:600;cursor:pointer}
    .composer button:active{transform:translateY(1px)}

    .hint{padding:10px 18px;font-size:13px;color:var(--muted);border-top:1px dashed #eef2ff}

    /* small screens */
    @media (max-width:520px){.container{margin:12px;padding:12px}.chat-area{height:380px}}
  </style>
</head>
<body>
  <div class="container">
    <div class="card" role="region" aria-label="DoctorBot chat widget">
      <header>
        <div style="width:44px;height:44px;border-radius:10px;background:linear-gradient(135deg,#60a5fa,#2563eb);display:flex;align-items:center;justify-content:center;color:white;font-weight:700">DB</div>
        <div>
          <h1>DoctorBot</h1>
          <p>Simple rule-based doctor-patient assistant — type symptoms and get guidance.</p>
        </div>
      </header>

      <main class="chat-area" id="chatArea" aria-live="polite"></main>

      <div class="composer">
        <input id="userInput" type="text" placeholder="Describe your symptom (e.g., 'I have a fever')" aria-label="Message input" />
        <button id="sendBtn" aria-label="Send message">Send</button>
      </div>

      <div class="hint">Tip: Try messages like "hi", "I have a fever", "I have cough", "stomach pain", "covid", or "thanks".</div>
    </div>
  </div>

  <script>
    // Simple rule-based replies (mirrors the provided Python rules)
    const rules = [
      {test: /\b(hello|hi|hey)\b/i, reply: "Hello! How are you feeling today?"},
      {test: /\bfever\b/i, reply: "I see. Do you also have symptoms like cough or headache?"},
      {test: /\bcough\b/i, reply: "You might have a common cold. Drink warm fluids and take rest."},
      {test: /\bheadache\b/i, reply: "Make sure you are hydrated. If pain continues, consider mild medication."},
      {test: /\b(stomach pain|stomachache|abdominal pain)\b/i, reply: "Try to rest and avoid heavy food. If pain is severe, you should visit a doctor."},
      {test: /\bcovid\b/i, reply: "If you have fever, cough, and breathing issues, please get a COVID-19 test immediately."},
      {test: /\b(thank you|thanks|thx)\b/i, reply: "You're welcome! Take care of your health."},
      {test: /\b(bye|goodbye)\b/i, reply: "Goodbye! Wishing you good health.", end:true}
    ];

    const chatArea = document.getElementById('chatArea');
    const input = document.getElementById('userInput');
    const sendBtn = document.getElementById('sendBtn');

    function appendMessage(text, who='bot'){
      const wrap = document.createElement('div');
      wrap.className = 'msg ' + (who === 'user' ? 'user' : 'bot');
      wrap.innerHTML = `<div>${escapeHtml(text)}</div>`;
      chatArea.appendChild(wrap);
      chatArea.scrollTop = chatArea.scrollHeight;
    }

    function escapeHtml(s){
      return s.replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;');
    }

    function getReply(text){
      for(const r of rules){
        if(r.test.test(text)) return r;
      }
      return null;
    }

    function botRespond(text){
      // small typing simulation
      const typing = document.createElement('div');
      typing.className = 'msg bot';
      typing.innerHTML = '<div>DoctorBot is typing…</div>';
      chatArea.appendChild(typing);
      chatArea.scrollTop = chatArea.scrollHeight;

      setTimeout(()=>{
        typing.remove();
        const match = getReply(text);
        if(match){
          appendMessage(match.reply, 'bot');
          if(match.end){
            appendMessage('Chat ended. Refresh the page to start again.', 'bot');
            input.disabled = true;
            sendBtn.disabled = true;
          }
        } else {
          appendMessage("I'm not sure about that. Please provide more details about your symptoms.", 'bot');
        }
      }, 600 + Math.random()*700);
    }

    function sendMessage(){
      const value = input.value.trim();
      if(!value) return;
      appendMessage(value, 'user');
      input.value = '';
      botRespond(value);
    }

    sendBtn.addEventListener('click', sendMessage);
    input.addEventListener('keydown', (e) => { if(e.key === 'Enter') sendMessage(); });

    // initial greeting
    window.addEventListener('load', ()=>{
      appendMessage('Hello! I am DoctorBot. How can I help you today? Type \"bye\" to end the chat.', 'bot');
    });
  </script>
</body>
</html>